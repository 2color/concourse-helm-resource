# Helm Resource for Concourse

Deploy to [Kubernetes Helm](https://github.com/kubernetes/helm) from [Concourse](https://concourse.ci/).

## Installing

Add the resource type to your pipeline:
```
resource_types:
- name: helm
  type: docker-image
  source:
    repository: linkyard/helm-resource
```


## Source Configuration

* `cluster_url`: *Required.* URL to Kubernetes Master API service
* `cluster_ca`: *Optional.* Base64 encoded PEM. Required if `cluster_url` is https.
* `admin_key`: *Optional.* Base64 encoded PEM. Required if `cluster_url` is https.
* `admin_cert`: *Optional.* Base64 encoded PEM. Required if `cluster_url` is https.


## Behavior

### `check`: Not supported.

### `in`: Not Supported


### `out`: Deploy the helm chart

Deploys a Helm chart onto the Kubernetes cluster. Tiller must be already installed
on the cluster.

#### Parameters
* `chart`: *Required.* File containing the helm chart to deploy (.tgz).
* `name`: *Optional.* File containing the name of the release. (Default: autogenerated by helm).
* `values`: *Optional.* File containing the values.yaml for the deployment.
* `replace`: *Optional.* Replace deleted release with same same. (Default: false)
* `wait_until_ready`: *Optional.* Set to `true` if helm should wait until all the resources om
    the chart are ready. (Default: `false`).



## Example

### Out
```
resources:
- name: myapp-helm
  type: helm
  source:
    cluster_url: https://kube-master.domain.example
    cluster_ca: _base64 encoded CA pem_
    admin_key: _base64 encoded key pem_
    admin_cert: _base64 encoded certificate pem_
```

```
- put: myapp-helm
  params:
    chart: source-repo/chart-0.0.1.tgz
    values: source-repo/values.yaml
```